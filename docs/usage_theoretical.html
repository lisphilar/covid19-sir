<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Usage: SIR-derived models &mdash; CovsirPhy  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Usage: S-R trend analysis" href="usage_phases.html" />
    <link rel="prev" title="Usage: exploratory data analysis" href="usage_dataset.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> CovsirPhy
          </a>
              <div class="version">
                2.22.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">CovsirPhy introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown/INSTALLATION.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown/WORKFLOW.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_quickest.html">Usage: quickest tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown/LOADING.html">Usage: data loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_dataset.html">Usage: exploratory data analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage: SIR-derived models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Preparation">Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-example-dataset-with-theoretical-values">Create example dataset with theoretical values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-model">SIR model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Non-dimensional-SIR-model">Non-dimensional SIR model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Reproduction-number">Reproduction number</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-D-model">SIR-D model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Non-dimensional-SIR-D-model">Non-dimensional SIR-D model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Reproduction number</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-F-model">SIR-F model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Non-dimensional-SIR-F-model">Non-dimensional SIR-F model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Reproduction number</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-F-with-exposed/waiting-cases">SIR-F with exposed/waiting cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Non-dimensional-SEWIR-F-model">Non-dimensional SEWIR-F model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Reproduction number</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-F-with-vaccination">SIR-F with vaccination</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-F-with-re-infection">SIR-F with re-infection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Impact-of-parameter-change">Impact of parameter change</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Compare-the-scenarios">Compare the scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#1.-Show-representative-values">1. Show representative values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2.-History-of-reproduction-number">2. History of reproduction number</a></li>
<li class="toctree-l4"><a class="reference internal" href="#3.-Simulated-number-of-cases-of-the-specified-variable">3. Simulated number of cases of the specified variable</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation-of-each-scenario">Simulation of each scenario</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage_phases.html">Usage: S-R trend analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_quick.html">Usage: scenario analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="covsirphy.html">covsirphy package</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown/TERM.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="CODE_OF_CONDUCT.html">Contributor Covenant Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="SECURITY.html">Security policy of CovsirPhy</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Guideline of contribution</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CovsirPhy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Usage: SIR-derived models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/usage_theoretical.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Usage:-SIR-derived-models">
<h1>Usage: SIR-derived models<a class="headerlink" href="#Usage:-SIR-derived-models" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/lisphilar/covid19-sir/blob/master/example/usage_theoretical.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>Here, we will create example datasets with simulated values of SIR-derived models. Then, we will perform scenario analysis with them.</p>
<section id="Preparation">
<h2>Preparation<a class="headerlink" href="#Preparation" title="Permalink to this headline"></a></h2>
<p>Prepare tha packages.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># !pip install covsirphy --upgrade</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">covsirphy</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="n">cs</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;2.22.2&#39;
</pre></div></div>
</div>
</section>
<section id="Create-example-dataset-with-theoretical-values">
<h2>Create example dataset with theoretical values<a class="headerlink" href="#Create-example-dataset-with-theoretical-values" title="Permalink to this headline"></a></h2>
<p>We will use <code class="docutils literal notranslate"><span class="pre">ExampleData</span></code> class to perform simulation with preset initial values and parameters. <span class="math notranslate nohighlight">\(\tau\)</span> (coeficient for non-dimensionalization) will be set as <span class="math notranslate nohighlight">\(1440\ \mathrm{[min]}\)</span>. The first date of records will be 01Jan2020 as an example.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set tau value and start date of records</span>
<span class="n">example_data</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">ExampleData</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01Jan2020&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>No records were registered at this time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check records</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">cleaned</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Country</th>
      <th>Province</th>
      <th>Confirmed</th>
      <th>Infected</th>
      <th>Fatal</th>
      <th>Recovered</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ExampleData</span></code> class is a child class of <code class="docutils literal notranslate"><span class="pre">JHUData</span></code>. i.e. We can use the example data in scenario analysis. Example codes will be shown in “Scenario analysis with theoretical data” subsection.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">issubclass</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">ExampleData</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">JHUData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">isinstance</span><span class="p">(</span><span class="n">example_data</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">JHUData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="SIR-model">
<h2>SIR model<a class="headerlink" href="#SIR-model" title="Permalink to this headline"></a></h2>
<p>Let’s start with the simlest SIR model proposed by <a class="reference external" href="https://royalsocietypublishing.org/doi/10.1098/rspa.1927.0118">Kermack, W. O., &amp; McKendrick, A. G. (1927)</a>. “Susceptible people” may meet “Infected” persons and may be confirmed as “Infected”. “Infected” patients will move to “Recovered” compertment later.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta I}{\longrightarrow} \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}  \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible (= Population - Confirmed)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Infected (=Confirmed - Recovered - Fatal)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Recovered or Fatal (= Recovered + Fatal)</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta\)</span>: Effective contact rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery (+ Mortality) rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
<div class="line-block">
<div class="line">Note:</div>
<div class="line">Though <span class="math notranslate nohighlight">\(R\)</span> in SIR model is “Recovered and have immunity”, we defines <span class="math notranslate nohighlight">\(R\)</span> as “Recovered or fatal”. This is because mortality rate cannot be ignored in our COVID-19 outbreak.</div>
</div>
<section id="Non-dimensional-SIR-model">
<h3>Non-dimensional SIR model<a class="headerlink" href="#Non-dimensional-SIR-model" title="Permalink to this headline"></a></h3>
<p>To simplify the model, we will remove the units of the variables from the ODE model.</p>
<p>Set <span class="math notranslate nohighlight">\((S, I, R) = N \times (x, y, z)\)</span> and <span class="math notranslate nohighlight">\((T, \beta, \gamma) = (\tau t, \tau^{-1} \rho, \tau^{-1} \sigma)\)</span>.</p>
<p>This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x}{\mathrm{d}t}= - \rho x y  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= \rho x y - \sigma y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
\end{align*}</div><p>Where <span class="math notranslate nohighlight">\(N\)</span> is the total population and <span class="math notranslate nohighlight">\(\tau\)</span> is a coefficient ([min], is an integer to simplify).</p>
<p>The model name and preset of parameter and initial values are registed as class variables of <code class="docutils literal notranslate"><span class="pre">SIR</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIR</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIR</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIR
{&#39;param_dict&#39;: {&#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Fatal or Recovered&#39;: 0, &#39;Infected&#39;: 1000, &#39;Susceptible&#39;: 999000}}
</pre></div></div>
</div>
<p>With the preset values, <code class="docutils literal notranslate"><span class="pre">ExampleData</span></code> instance will produce a example data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIR</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can get example records with <code class="docutils literal notranslate"><span class="pre">ExampleData.specialized()</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Susceptible</th>
      <th>Infected</th>
      <th>Fatal or Recovered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-02</td>
      <td>998787</td>
      <td>1133</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-03</td>
      <td>998547</td>
      <td>1283</td>
      <td>170</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-04</td>
      <td>998273</td>
      <td>1454</td>
      <td>273</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-05</td>
      <td>997964</td>
      <td>1647</td>
      <td>389</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-06</td>
      <td>997614</td>
      <td>1865</td>
      <td>521</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">covsirphy.line_plot()</span></code> function, figures will be shown (or saved when <code class="docutils literal notranslate"><span class="pre">filename</span></code> argument was applied).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Line plot with the example data</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_19_0.png" src="_images/usage_theoretical_19_0.png" />
</div>
</div>
</section>
<section id="Reproduction-number">
<h3>Reproduction number<a class="headerlink" href="#Reproduction-number" title="Permalink to this headline"></a></h3>
<p>Reproduction number of SIR model is defined as follows.</p>
<div class="math notranslate nohighlight">
\begin{align*}
R_0 = \rho \sigma^{-1} = \beta \gamma^{-1}
\end{align*}</div><p><span class="math notranslate nohighlight">\(R_0\)</span> (“R naught”) means “the average number of secondary infections caused by an infected host” (<a class="reference external" href="https://towardsdatascience.com/infection-modeling-part-1-87e74645568a">external link: Infection Modeling — Part 1</a>). When <span class="math notranslate nohighlight">\(x=\frac{1}{R_0}\)</span>, <span class="math notranslate nohighlight">\(\frac{\mathrm{d}y}{\mathrm{d}t}=0\)</span> (the number of infected cases does not change).</p>
<p>We can calculate reproduction number using <code class="docutils literal notranslate"><span class="pre">.calc_r0()</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate reproduction number</span>
<span class="c1"># Note: population value will be applied, but not used in calculation</span>
<span class="n">param_dict</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIR</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">[</span><span class="s2">&quot;param_dict&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">model_instance</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIR</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="o">**</span><span class="n">param_dict</span><span class="p">)</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">model_instance</span><span class="o">.</span><span class="n">calc_r0</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reproduction number of </span><span class="si">{</span><span class="n">model_instance</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model: </span><span class="si">{</span><span class="n">r0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reproduction number of SIR model: 2.67
</pre></div></div>
</div>
</section>
</section>
<section id="SIR-D-model">
<h2>SIR-D model<a class="headerlink" href="#SIR-D-model" title="Permalink to this headline"></a></h2>
<p>Because we are measuring the number of fatal cases and recovered cases separately, we can use two variables (“Recovered” and “Deaths”) instead of “Recovered + Deaths” in the mathematical model. We call this model as SIR-D model.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta  I}{\longrightarrow}\ &amp; \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}  \\
&amp; \mathrm{I} \overset{\alpha}{\longrightarrow} \mathrm{D}  \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible (= Population - Confirmed)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Infected (=Confirmed - Recovered - Fatal)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Recovered</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{D}\)</span>: Fatal</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span>: Mortality rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span>: Effective contact rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
<section id="Non-dimensional-SIR-D-model">
<h3>Non-dimensional SIR-D model<a class="headerlink" href="#Non-dimensional-SIR-D-model" title="Permalink to this headline"></a></h3>
<p>Set <span class="math notranslate nohighlight">\((S, I, R, D) = N \times (x, y, z, w)\)</span> and <span class="math notranslate nohighlight">\((T, \alpha, \beta, \gamma) = (\tau t, \tau^{-1} \kappa, \tau^{-1} \rho, \tau^{-1} \sigma)\)</span>.
This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x}{\mathrm{d}t}= - \rho x y  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= \rho x y - (\sigma + \kappa) y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
&amp; \frac{\mathrm{d}w}{\mathrm{d}t}= \kappa y  \\
\end{align*}</div><p>The model name and preset values are registered in <code class="docutils literal notranslate"><span class="pre">SIRD</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIR-D
{&#39;param_dict&#39;: {&#39;kappa&#39;: 0.005, &#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Fatal&#39;: 0,
             &#39;Infected&#39;: 1000,
             &#39;Recovered&#39;: 0,
             &#39;Susceptible&#39;: 999000}}
</pre></div></div>
</div>
<p>Example data is here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_26_0.png" src="_images/usage_theoretical_26_0.png" />
</div>
</div>
</section>
<section id="id1">
<h3>Reproduction number<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h3>
<p>Reproduction number of SIR-D model is defined as follows.</p>
<div class="math notranslate nohighlight">
\begin{align*}
R_0 = \rho (\sigma + \kappa)^{-1} = \beta (\gamma + \alpha)^{-1}
\end{align*}</div><p>We can calculate reproduction number using <code class="docutils literal notranslate"><span class="pre">.calc_r0()</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate reproduction number</span>
<span class="c1"># Note: population value will be applied, but not used in calculation</span>
<span class="n">param_dict</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">[</span><span class="s2">&quot;param_dict&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">model_instance</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="o">**</span><span class="n">param_dict</span><span class="p">)</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">model_instance</span><span class="o">.</span><span class="n">calc_r0</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reproduction number of </span><span class="si">{</span><span class="n">model_instance</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model: </span><span class="si">{</span><span class="n">r0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reproduction number of SIR-D model: 2.5
</pre></div></div>
</div>
</section>
</section>
<section id="SIR-F-model">
<h2>SIR-F model<a class="headerlink" href="#SIR-F-model" title="Permalink to this headline"></a></h2>
<p>In the initial phase of COVID-19 outbreak, many cases were confirmed after they died. To consider this issue, “S + I <span class="math notranslate nohighlight">\(\to\)</span> Fatal + I” should be added. We call the next model as SIR-F model. This is an original model of CovsirPhy. When <span class="math notranslate nohighlight">\(\alpha_{1}=0\)</span>, no difference with the SIR-D model.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta I}{\longrightarrow} \mathrm{S}^\ast \overset{\alpha_1}{\longrightarrow}\ &amp; \mathrm{F}    \\
\mathrm{S}^\ast \overset{1 - \alpha_1}{\longrightarrow}\ &amp; \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}    \\
&amp; \mathrm{I} \overset{\alpha_2}{\longrightarrow} \mathrm{F}    \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible (= Population - Confirmed)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span>: Confirmed and un-categorized</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Confirmed and categorized as Infected</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Confirmed and categorized as Recovered</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{F}\)</span>: Confirmed and categorzied as Fatal</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha_1\)</span>: Direct fatality probability of <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> (non-dimensional)</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha_2\)</span>: Mortality rate of Infected cases <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span>: Effective contact rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
<div class="line-block">
<div class="line">Notes on <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> variable:</div>
<div class="line"><span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> describes the cases who are actually carriers of the disease without anyone (including themselves) knowing about it, who either die and they are confirmed positive after death, while some others are moved to infected after being confirmed.</div>
</div>
<p>In JHU-style dataset, we know the number of cases who were confirmed with COVID-19, but we do not know the number of died cases who died without COVID-19. Essentially <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> serves as an auxiliary compartment in SIR-F model to separate the two death situations and insert a probability factor of {<span class="math notranslate nohighlight">\(\alpha_1\)</span>, <span class="math notranslate nohighlight">\(1 - \alpha_1\)</span>}.</p>
<div class="line-block">
<div class="line">Notes on the difference of SIR-D and SIR-F model:</div>
<div class="line"><span class="math notranslate nohighlight">\(\alpha_1\)</span> is small at this time because performance of PCR tests was improved, but we can use SIR-F model rather than SIR-D model as an enhanced model even now becase <span class="math notranslate nohighlight">\(\alpha_1\)</span> can be 0 in the ODE model.</div>
</div>
<p>SIR-F model was developed with <a class="reference external" href="https://www.kaggle.com/lisphilar/covid-19-data-with-sir-model#SIR-to-SIR-F">Kaggle: COVID-19 data with SIR model</a>.</p>
<section id="Non-dimensional-SIR-F-model">
<h3>Non-dimensional SIR-F model<a class="headerlink" href="#Non-dimensional-SIR-F-model" title="Permalink to this headline"></a></h3>
<p>Set <span class="math notranslate nohighlight">\((S, I, R, F) = N \times (x, y, z, w)\)</span> and <span class="math notranslate nohighlight">\((T, \alpha_1, \alpha_2, \beta, \gamma) = (\tau t, \theta, \tau^{-1} \kappa, \tau^{-1} \rho, \tau^{-1} \sigma)\)</span>.
This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x}{\mathrm{d}t}= - \rho x y  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= \rho (1-\theta) x y - (\sigma + \kappa) y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
&amp; \frac{\mathrm{d}w}{\mathrm{d}t}= \rho \theta x y + \kappa y  \\
\end{align*}</div><p>We use <code class="docutils literal notranslate"><span class="pre">SIRF</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIR-F
{&#39;param_dict&#39;: {&#39;kappa&#39;: 0.005, &#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075, &#39;theta&#39;: 0.002},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Fatal&#39;: 0,
             &#39;Infected&#39;: 1000,
             &#39;Recovered&#39;: 0,
             &#39;Susceptible&#39;: 999000}}
</pre></div></div>
</div>
<p>Example data is here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_36_0.png" src="_images/usage_theoretical_36_0.png" />
</div>
</div>
</section>
<section id="id2">
<h3>Reproduction number<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<p>Reproduction number of SIR-F model is defined as follows.</p>
<div class="math notranslate nohighlight">
\begin{align*}
R_0 = \rho (1 - \theta) (\sigma + \kappa)^{-1} = \beta (1 - \alpha_1) (\gamma + \alpha_2)^{-1}
\end{align*}</div><p>We can calculate reproduction number using <code class="docutils literal notranslate"><span class="pre">.calc_r0()</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate reproduction number</span>
<span class="c1"># Note: population value will be applied, but not used in calculation</span>
<span class="n">param_dict</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">[</span><span class="s2">&quot;param_dict&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">model_instance</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="o">**</span><span class="n">param_dict</span><span class="p">)</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">model_instance</span><span class="o">.</span><span class="n">calc_r0</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reproduction number of </span><span class="si">{</span><span class="n">model_instance</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model: </span><span class="si">{</span><span class="n">r0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reproduction number of SIR-F model: 2.5
</pre></div></div>
</div>
</section>
</section>
<section id="SIR-F-with-exposed/waiting-cases">
<h2>SIR-F with exposed/waiting cases<a class="headerlink" href="#SIR-F-with-exposed/waiting-cases" title="Permalink to this headline"></a></h2>
<p>The next model is SEWIR-F model.
The number of exposed cases in latent period (E) and wating cases for confirmation (W) are un-measurable variables, but key variables as well as S, I, R, F. If E and W are large, outbreak will occur in the near future. Let’s replace S<span class="math notranslate nohighlight">\(\overset{\beta I}{\longrightarrow}\)</span>S<span class="math notranslate nohighlight">\(^\ast\)</span> as follows because W also has infectivity.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta_1 (W+I)}{\longrightarrow} \mathrm{E} \overset{\beta_2}{\longrightarrow} \mathrm{W} \overset{\beta_3}{\longrightarrow} \mathrm{S}^\ast \overset{\alpha_1}{\longrightarrow}\ &amp; \mathrm{F}    \\
\mathrm{S}^\ast \overset{1 - \alpha_1}{\longrightarrow}\ &amp; \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}    \\
&amp; \mathrm{I} \overset{\alpha_2}{\longrightarrow} \mathrm{F}    \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{E}\)</span>: Exposed and in latent period (without infectivity)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{W}\)</span>: Waiting for confirmaion fiagnosis (with infectivity)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span>: Confirmed and un-categorized</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Confirmed and categorized as Infected</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Confirmed and categorized as Recovered</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{F}\)</span>: Confirmed and categorzied as Fatal</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha_1\)</span>: Direct fatality probability of <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> (non-dimensional)</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha_2\)</span>: Mortality rate of Infected cases <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span>: Exposure rate (the nymber of encounter with the virus in a minute) <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span>: Inverse of latent period <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_3\)</span>: Inverse of waiting time for confirmation <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
<section id="Non-dimensional-SEWIR-F-model">
<h3>Non-dimensional SEWIR-F model<a class="headerlink" href="#Non-dimensional-SEWIR-F-model" title="Permalink to this headline"></a></h3>
<p>Set <span class="math notranslate nohighlight">\((S, E, W, I, R, F) = N \times (x_1, x_2, x_3, y, z, w)\)</span>, <span class="math notranslate nohighlight">\((T, \alpha_1) = (\tau t, \theta)\)</span> and <span class="math notranslate nohighlight">\((\alpha_2, \beta_i, \gamma) = \tau^{-1} \times (\kappa, \rho_i, \sigma)\)</span>.
This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x_1}{\mathrm{d}t}= - \rho_1 x_1 (x_3 + y)  \\
&amp; \frac{\mathrm{d}x_2}{\mathrm{d}t}= \rho_1 x_1 (x_3 + y) - \rho_2 x_2  \\
&amp; \frac{\mathrm{d}x_3}{\mathrm{d}t}= \rho_2 x_2 - \rho_3 x_3  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= (1-\theta) \rho_3 x_3 - (\sigma + \kappa) y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
&amp; \frac{\mathrm{d}w}{\mathrm{d}t}= \theta \rho_3 x_3 + \kappa y  \\
\end{align*}</div><div class="line-block">
<div class="line">Note:</div>
<div class="line"><strong>We cannot use SEWIR-F model for parameter estimation because we do not have records of Exposed and Waiting. Please use SIR-F model with covsirphy.SIRF class.</strong></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SEWIRF</span></code> class is for the SEWIR-F model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SEWIR-F
{&#39;param_dict&#39;: {&#39;kappa&#39;: 0.005,
                &#39;rho1&#39;: 0.2,
                &#39;rho2&#39;: 0.167,
                &#39;rho3&#39;: 0.167,
                &#39;sigma&#39;: 0.075,
                &#39;theta&#39;: 0.002},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Exposed&#39;: 3000,
             &#39;Fatal&#39;: 0,
             &#39;Infected&#39;: 1000,
             &#39;Recovered&#39;: 0,
             &#39;Susceptible&#39;: 994000,
             &#39;Waiting&#39;: 2000}}
</pre></div></div>
</div>
<p>Example records are here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_45_0.png" src="_images/usage_theoretical_45_0.png" />
</div>
</div>
</section>
<section id="id3">
<h3>Reproduction number<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h3>
<p>Reproduction number of SEWIR-F model is defined as follows.</p>
<div class="math notranslate nohighlight">
\begin{align*}
R_0 = \rho_1 /\rho_2 * \rho_3 (1-\theta) (\sigma + \kappa)^{-1}
\end{align*}</div><p>We can calculate reproduction number using <code class="docutils literal notranslate"><span class="pre">.calc_r0()</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate reproduction number</span>
<span class="c1"># Note: population value will be applied, but not used in calculation</span>
<span class="n">param_dict</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">[</span><span class="s2">&quot;param_dict&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">model_instance</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="o">**</span><span class="n">param_dict</span><span class="p">)</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">model_instance</span><span class="o">.</span><span class="n">calc_r0</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reproduction number of </span><span class="si">{</span><span class="n">model_instance</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model: </span><span class="si">{</span><span class="n">r0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reproduction number of SEWIR-F model: 2.49
</pre></div></div>
</div>
</section>
</section>
<section id="SIR-F-with-vaccination">
<h2>SIR-F with vaccination<a class="headerlink" href="#SIR-F-with-vaccination" title="Permalink to this headline"></a></h2>
<p>Vaccination is a key factor to prevent outbreak as you know.</p>
<p>In the previous version, we defined SIR-FV model with <span class="math notranslate nohighlight">\(\omega\)</span> (vaccination rate) and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\mathrm{d}S}{\mathrm{d}T}= - \beta S I - \omega N  \\\end{split}\]</div>
<p>However, <strong>SIR-FV model was removed because vaccinated persons may move to the other compartments, including “Susceprtible”. Please use SIR-F model for simulation and parameter estimation with adjusted parameter values, considering the impact of vaccinations on infectivity, its effectivity and safety.</strong></p>
</section>
<section id="SIR-F-with-re-infection">
<h2>SIR-F with re-infection<a class="headerlink" href="#SIR-F-with-re-infection" title="Permalink to this headline"></a></h2>
<p>Re-infection (Recovered -&gt; Susceptble) is sometimes reported and we can consider SIR-S (SIR-FS) model. However, this is not impremented at this time because we do not have data regarding re-infection. SIR-F model could be the final model in our data-driven approach at this time.</p>
<p>Re-infection changes the parameter values of SIR-F model. There are two patterns.</p>
<ol class="arabic simple">
<li><p>If re-infected case are counted as new confirmed cases and removed from “Recovered” compartment, <span class="math notranslate nohighlight">\(\sigma\)</span> will be decreased.</p></li>
<li><p>If re-infected cases are counted as new confirmed cases and <strong>NOT</strong> removed from “Recovered” compartment, <span class="math notranslate nohighlight">\(\rho\)</span> will be increased because “Susceptible” will be decreased.</p></li>
</ol>
</section>
<section id="Impact-of-parameter-change">
<h2>Impact of parameter change<a class="headerlink" href="#Impact-of-parameter-change" title="Permalink to this headline"></a></h2>
<p>Because <code class="docutils literal notranslate"><span class="pre">ExampleData</span></code> class is a subclass of <code class="docutils literal notranslate"><span class="pre">JHUData</span></code>, we can perform scenario analysis with example datasets easily. We evaluate the impact of parameter changes.</p>
<p>Here, we will use the following scenarios. For explanation, <span class="math notranslate nohighlight">\(\tau=1440\)</span>, the start date is 01Jan2020, population is 1,000,000 and country name is “Theoretical”. <strong>Their scenarios are not based on actual data.</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 21%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>01Jan2020 - 31Jan2020</p></th>
<th class="head"><p>01Feb2020 - 31Dec2020</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Main</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F</p></td>
</tr>
<tr class="row-odd"><td><p>Lockdown</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F with 50% of <span class="math notranslate nohighlight">\(\rho\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Medicine</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F with 50% of <span class="math notranslate nohighlight">\(\kappa\)</span> and 200% of <span class="math notranslate nohighlight">\(\sigma\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Vaccine</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F with 80% of <span class="math notranslate nohighlight">\(\rho\)</span>, 60% of <span class="math notranslate nohighlight">\(\kappa\)</span> and 120% of <span class="math notranslate nohighlight">\(\sigma\)</span></p></td>
</tr>
</tbody>
</table>
<p>As baseline (main scenario), we use preset values of the SIR-F model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Preset of SIR-F parameters and initial values</span>
<span class="n">preset_dict</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">[</span><span class="s2">&quot;param_dict&quot;</span><span class="p">]</span>
<span class="n">preset_dict</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;theta&#39;: 0.002, &#39;kappa&#39;: 0.005, &#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075}
</pre></div></div>
</div>
<p>Create records from 01Jan2020 to 31Jan2020. These records will be used commonly in the scenarios.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Theoretical&quot;</span><span class="p">}</span>
<span class="c1"># Create dataset from 01Jan2020 to 31Jan2020</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="p">,</span> <span class="n">step_n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Create <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> instance for scenario analysis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create Scenario instance</span>
<span class="n">snl</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">Scenario</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">snl</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">example_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Then, confirm the records with <code class="docutils literal notranslate"><span class="pre">Scenario.records()</span></code> instance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show records with Scenario instance</span>
<span class="n">record_df</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">records</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">record_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">record_df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_58_0.png" src="_images/usage_theoretical_58_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Infected</th>
      <th>Fatal</th>
      <th>Recovered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-02</td>
      <td>1127</td>
      <td>6</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-03</td>
      <td>1270</td>
      <td>12</td>
      <td>169</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-04</td>
      <td>1430</td>
      <td>19</td>
      <td>271</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-05</td>
      <td>1612</td>
      <td>28</td>
      <td>385</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-06</td>
      <td>1816</td>
      <td>37</td>
      <td>513</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Infected</th>
      <th>Fatal</th>
      <th>Recovered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>2020-01-27</td>
      <td>21210</td>
      <td>940</td>
      <td>13068</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2020-01-28</td>
      <td>23730</td>
      <td>1061</td>
      <td>14753</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2020-01-29</td>
      <td>26524</td>
      <td>1196</td>
      <td>16637</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2020-01-30</td>
      <td>29616</td>
      <td>1347</td>
      <td>18741</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2020-01-31</td>
      <td>33030</td>
      <td>1515</td>
      <td>21088</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="line-block">
<div class="line">Note:</div>
<div class="line">Record on 01Jan2020 was removed because the number of recovered cases is 0 and this sometimes causes error in estimation.</div>
</div>
<p>Then, set the records from 02Jan2020 to 31Jan2020 as the 0th phase. The 0th phase is commonly used in the all scenarios.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set 0th phase from 02Jan2020 to 31Jan2020 with preset parameter values</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">include_past</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Jan2020&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="p">,</span> <span class="o">**</span><span class="n">preset_dict</span><span class="p">)</span>
<span class="c1"># Show summary</span>
<span class="n">snl</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>Start</th>
      <th>End</th>
      <th>Population</th>
      <th>ODE</th>
      <th>Rt</th>
      <th>theta</th>
      <th>kappa</th>
      <th>rho</th>
      <th>sigma</th>
      <th>tau</th>
      <th>alpha1 [-]</th>
      <th>1/alpha2 [day]</th>
      <th>1/beta [day]</th>
      <th>1/gamma [day]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.5</td>
      <td>0.002</td>
      <td>0.005</td>
      <td>0.2</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Set the 1st phase with the same parameter values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add main scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Main&quot;</span><span class="p">)</span>
<span class="n">snl</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>Start</th>
      <th>End</th>
      <th>Population</th>
      <th>ODE</th>
      <th>Rt</th>
      <th>theta</th>
      <th>kappa</th>
      <th>rho</th>
      <th>sigma</th>
      <th>tau</th>
      <th>alpha1 [-]</th>
      <th>1/alpha2 [day]</th>
      <th>1/beta [day]</th>
      <th>1/gamma [day]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.5</td>
      <td>0.002</td>
      <td>0.005</td>
      <td>0.2</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.5</td>
      <td>0.002</td>
      <td>0.005</td>
      <td>0.2</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Copy the main scenario and name it as Lockdown scenario. <code class="docutils literal notranslate"><span class="pre">Scenario.clear()</span></code> removes the future phase (th 1st phase here) and we will register th 1st phase with halved <span class="math notranslate nohighlight">\(\rho\)</span> value. Lockdown is supposed to reduce effective contact rate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add lockdown scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lockdown&quot;</span><span class="p">)</span>
<span class="c1"># Get rho value of the 0th phase and halve it</span>
<span class="n">rho_lock</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="c1"># Add th 1st phase with the calculated rho value</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lockdown&quot;</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="n">rho_lock</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;covsirphy.analysis.scenario.Scenario at 0x7f024da5cfd0&gt;
</pre></div></div>
</div>
<p>Next, we define medicine scenario. <span class="math notranslate nohighlight">\(\kappa\)</span> will be halved and <span class="math notranslate nohighlight">\(\sigma\)</span> will be doubled. New medicines may reduce the severity rate and enhance recovery.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add medicine scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Medicine&quot;</span><span class="p">)</span>
<span class="n">kappa_med</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kappa&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="n">sigma_med</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Medicine&quot;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa_med</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_med</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;covsirphy.analysis.scenario.Scenario at 0x7f024da5cfd0&gt;
</pre></div></div>
</div>
<p>We define vaccine scenario. As noted in “SIR-F model with vaccination” section, vaccination impacts on <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\kappa\)</span> with depending on its effectivity and safety. If vaccinations impact on infectivity, <span class="math notranslate nohighlight">\(\rho\)</span> value will be also changed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add vaccine scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vaccine&quot;</span><span class="p">)</span>
<span class="n">rho_vac</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span>
<span class="n">kappa_vac</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kappa&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.6</span>
<span class="n">sigma_vac</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vaccine&quot;</span><span class="p">,</span>  <span class="n">rho</span><span class="o">=</span><span class="n">rho_vac</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa_vac</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_vac</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;covsirphy.analysis.scenario.Scenario at 0x7f024da5cfd0&gt;
</pre></div></div>
</div>
<p>See the phase settings with <code class="docutils literal notranslate"><span class="pre">Scenario.summary()</span></code> as always.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show summary</span>
<span class="n">snl</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Type</th>
      <th>Start</th>
      <th>End</th>
      <th>Population</th>
      <th>ODE</th>
      <th>Rt</th>
      <th>theta</th>
      <th>kappa</th>
      <th>rho</th>
      <th>sigma</th>
      <th>tau</th>
      <th>alpha1 [-]</th>
      <th>1/alpha2 [day]</th>
      <th>1/beta [day]</th>
      <th>1/gamma [day]</th>
    </tr>
    <tr>
      <th>Scenario</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Main</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Lockdown</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>1.25</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.10</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>10.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Medicine</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>1.31</td>
      <td>0.002</td>
      <td>0.0025</td>
      <td>0.20</td>
      <td>0.150</td>
      <td>1440</td>
      <td>0.002</td>
      <td>400.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Vaccine</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200.0</td>
      <td>5.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>1.72</td>
      <td>0.002</td>
      <td>0.0030</td>
      <td>0.16</td>
      <td>0.090</td>
      <td>1440</td>
      <td>0.002</td>
      <td>333.0</td>
      <td>6.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Show the parameter setting with <code class="docutils literal notranslate"><span class="pre">Scenario.history()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show the history of rho as a dataframe and a figure</span>
<span class="c1"># we can set theta/kappa/rho/sigma for SIR-F model</span>
<span class="n">snl</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_73_0.png" src="_images/usage_theoretical_73_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Scenario</th>
      <th>Lockdown</th>
      <th>Main</th>
      <th>Medicine</th>
      <th>Vaccine</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-02</th>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2020-01-03</th>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2020-01-04</th>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2020-01-05</th>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2020-01-06</th>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="Compare-the-scenarios">
<h3>Compare the scenarios<a class="headerlink" href="#Compare-the-scenarios" title="Permalink to this headline"></a></h3>
<p>We will compare the scenarios to discuss the impact of changing parameters. We have some methods for that.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Scenario.describe()</span></code> shows representative values as a dataframe.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Scenario.history(target=&quot;Rt&quot;)</span></code> shows the history of automatically calculated reproduction number.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Scenario.history(target=&quot;variable</span> <span class="pre">name&quot;)</span></code> shows simulated number of cases for the specified variable.</p></li>
<li><p>If you have any ideas, please create <a class="reference external" href="https://github.com/lisphilar/covid19-sir/issues">issues</a>! :)</p></li>
</ol>
<section id="1.-Show-representative-values">
<h4>1. Show representative values<a class="headerlink" href="#1.-Show-representative-values" title="Permalink to this headline"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Scenario.describe()</span></code> compares</p>
<ul class="simple">
<li><p>max number of infected cases and the date with the max value,</p></li>
<li><p>the number of confirmed/infected/fatal cases on the next date of the last phase, and</p></li>
<li><p>reproduction numbers for the phases with different numbers.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Describe the scenarios</span>
<span class="n">snl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>max(Infected)</th>
      <th>argmax(Infected)</th>
      <th>Confirmed on 31Dec2020</th>
      <th>Infected on 31Dec2020</th>
      <th>Fatal on 31Dec2020</th>
      <th>1st_Rt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Main</th>
      <td>232800</td>
      <td>02Mar2020</td>
      <td>890043</td>
      <td>0</td>
      <td>57295</td>
      <td>2.50</td>
    </tr>
    <tr>
      <th>Lockdown</th>
      <td>44360</td>
      <td>12Mar2020</td>
      <td>436501</td>
      <td>137</td>
      <td>28090</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>Medicine</th>
      <td>51404</td>
      <td>24Feb2020</td>
      <td>483356</td>
      <td>0</td>
      <td>9911</td>
      <td>1.31</td>
    </tr>
    <tr>
      <th>Vaccine</th>
      <td>113534</td>
      <td>09Mar2020</td>
      <td>708848</td>
      <td>0</td>
      <td>24917</td>
      <td>1.72</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="2.-History-of-reproduction-number">
<h4>2. History of reproduction number<a class="headerlink" href="#2.-History-of-reproduction-number" title="Permalink to this headline"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Scenario.history(target=&quot;Rt&quot;)</span></code> shows the history of reproduction number.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show the history of reproduction number</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;Rt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_78_0.png" src="_images/usage_theoretical_78_0.png" />
</div>
</div>
</section>
<section id="3.-Simulated-number-of-cases-of-the-specified-variable">
<h4>3. Simulated number of cases of the specified variable<a class="headerlink" href="#3.-Simulated-number-of-cases-of-the-specified-variable" title="Permalink to this headline"></a></h4>
<p>We can also set Confired/Infected/Fatal/Recovered as the target of <code class="docutils literal notranslate"><span class="pre">Scenario.history()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The number of infected cases</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;Infected&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_80_0.png" src="_images/usage_theoretical_80_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The number of fatal cases</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;Fatal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_81_0.png" src="_images/usage_theoretical_81_0.png" />
</div>
</div>
</section>
</section>
<section id="Simulation-of-each-scenario">
<h3>Simulation of each scenario<a class="headerlink" href="#Simulation-of-each-scenario" title="Permalink to this headline"></a></h3>
<p>We can simulate the all kind of the number of cases for a specific scenario with <code class="docutils literal notranslate"><span class="pre">Scenario.simulate()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Main scenario</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Main&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_83_0.png" src="_images/usage_theoretical_83_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Lockdown scenario</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lockdown&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_84_0.png" src="_images/usage_theoretical_84_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Medicine scenario</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Medicine&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_85_0.png" src="_images/usage_theoretical_85_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Vaccine scenario</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vaccine&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_86_0.png" src="_images/usage_theoretical_86_0.png" />
</div>
</div>
<p><strong>For futher analysis, let’s change the parameter settings and add new scenarios!</strong></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage_dataset.html" class="btn btn-neutral float-left" title="Usage: exploratory data analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usage_phases.html" class="btn btn-neutral float-right" title="Usage: S-R trend analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, CovsirPhy Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>