

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Usage: SIR-derived models &mdash; CovsirPhy  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="covsirphy package" href="covsirphy.html" />
    <link rel="prev" title="Usage: phases" href="usage_phases.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CovsirPhy
          

          
          </a>

          
            
            
              <div class="version">
                2.17.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">CovsirPhy introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown/INSTALLATION.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown/INSTALLATION.html#dataset-preparation">Dataset preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_quickest.html">Usage: quickest tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_quick.html">Usage: scenario analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_dataset.html">Usage: datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_phases.html">Usage: phases</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage: SIR-derived models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Preparation">Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-example-dataset-with-theoretical-values">Create example dataset with theoretical values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-model">SIR model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Non-dimensional-SIR-model">Non-dimensional SIR model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-D-model">SIR-D model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Non-dimensional-SIR-D-model">Non-dimensional SIR-D model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-F-model">SIR-F model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Non-dimensional-SIR-F-model">Non-dimensional SIR-F model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#SEWIR-F-model-(SIR-F-with-exposed/waiting-cases)">SEWIR-F model (SIR-F with exposed/waiting cases)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Non-dimensional-SEWIR-F-model">Non-dimensional SEWIR-F model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-F-model-with-vaccination">SIR-F model with vaccination</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SIR-S-model">SIR-S model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Scenario-analysis-with-theoretical-data">Scenario analysis with theoretical data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Compare-the-scenarios">Compare the scenarios</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation-of-each-scenario">Simulation of each scenario</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="covsirphy.html">covsirphy package</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown/TERM.html">Term definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="CODE_OF_CONDUCT.html">Contributor Covenant Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="SECURITY.html">Security policy of CovsirPhy</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Guideline of contribution</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CovsirPhy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Usage: SIR-derived models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/usage_theoretical.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Usage:-SIR-derived-models">
<h1>Usage: SIR-derived models<a class="headerlink" href="#Usage:-SIR-derived-models" title="Permalink to this headline">¶</a></h1>
<p>Here, we will create an example dataset with theoretical values of SIR-derived model. Then, we will perform scenario analysis with it.</p>
<div class="section" id="Preparation">
<h2>Preparation<a class="headerlink" href="#Preparation" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">covsirphy</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="n">cs</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;2.17.0&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instance to save population values</span>
<span class="n">population_data</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">PopulationData</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">population_data</span><span class="o">.</span><span class="n">cleaned</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ISO3</th>
      <th>Country</th>
      <th>Province</th>
      <th>Date</th>
      <th>Population</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Create-example-dataset-with-theoretical-values">
<h2>Create example dataset with theoretical values<a class="headerlink" href="#Create-example-dataset-with-theoretical-values" title="Permalink to this headline">¶</a></h2>
<p>We will use <code class="docutils literal notranslate"><span class="pre">ExampleData</span></code> class to produce theoretical values. Model descriptions (<code class="docutils literal notranslate"><span class="pre">SIR</span></code> class etc.) have preset of parameter values. Then, <span class="math notranslate nohighlight">\(\tau\)</span> (coeficient for non-dimensionalization) will be set as <span class="math notranslate nohighlight">\(1440\ \mathrm{[min]}\)</span>. The first date of records will be 01Jan2020 as an example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set tau value and start date of records</span>
<span class="n">example_data</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">ExampleData</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01Jan2020&quot;</span><span class="p">)</span>
<span class="c1"># No records has been registered</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">cleaned</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Country</th>
      <th>Province</th>
      <th>Confirmed</th>
      <th>Infected</th>
      <th>Fatal</th>
      <th>Recovered</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ExampleData</span></code> class is a child class of <code class="docutils literal notranslate"><span class="pre">JHUData</span></code>. This means that we can use the example data in scenario analysis. Example codes will be shown in “Scenario analysis with theoretical data” subsection.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">issubclass</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">ExampleData</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">JHUData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">isinstance</span><span class="p">(</span><span class="n">example_data</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">JHUData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="SIR-model">
<h2>SIR model<a class="headerlink" href="#SIR-model" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with simle SIR model. Details of models are explained in <a class="reference external" href="https://www.kaggle.com/lisphilar/covid-19-data-with-sir-model#SIR-to-SIR-F">Kaggle: COVID-19 data with SIR model</a>.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta I}{\longrightarrow} \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}  \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible (= Population - Confirmed)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Infected (=Confirmed - Recovered - Fatal)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Recovered or Fatal (= Recovered + Fatal)</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta\)</span>: Effective contact rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery (+ Mortality) rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
<div class="line-block">
<div class="line">Note:</div>
<div class="line">Though R in SIR model is “Recovered and have immunity”, we defines “R as Recovered or fatal”. This is because mortality rate cannot be ignored in the real COVID-19 data.</div>
</div>
<div class="section" id="Non-dimensional-SIR-model">
<h3>Non-dimensional SIR model<a class="headerlink" href="#Non-dimensional-SIR-model" title="Permalink to this headline">¶</a></h3>
<p>To simplify the model, we will remove the units of the variables from ODE.</p>
<p>Set <span class="math notranslate nohighlight">\((S, I, R) = N \times (x, y, z)\)</span> and <span class="math notranslate nohighlight">\((T, \beta, \gamma) = (\tau t, \tau^{-1} \rho, \tau^{-1} \sigma)\)</span>.</p>
<p>This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x}{\mathrm{d}t}= - \rho x y  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= \rho x y - \sigma y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
\end{align*}</div><p>Where <span class="math notranslate nohighlight">\(N\)</span> is the total population and <span class="math notranslate nohighlight">\(\tau\)</span> is a coefficient ([min], is an integer to simplify).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIR</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIR</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIR
{&#39;param_dict&#39;: {&#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Fatal or Recovered&#39;: 0, &#39;Infected&#39;: 1000, &#39;Susceptible&#39;: 999000}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIR</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_13_0.png" src="_images/usage_theoretical_13_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="SIR-D-model">
<h2>SIR-D model<a class="headerlink" href="#SIR-D-model" title="Permalink to this headline">¶</a></h2>
<p>Because we are measuring the number of fatal cases and recovered cases separately, we can use two variables (“Recovered” and “Deaths”) instead of “Recovered + Deaths” in the mathematical model.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta  I}{\longrightarrow}\ &amp; \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}  \\
&amp; \mathrm{I} \overset{\alpha}{\longrightarrow} \mathrm{D}  \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible (= Population - Confirmed)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Infected (=Confirmed - Recovered - Fatal)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Recovered</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{D}\)</span>: Fatal</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span>: Mortality rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span>: Effective contact rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
<div class="section" id="Non-dimensional-SIR-D-model">
<h3>Non-dimensional SIR-D model<a class="headerlink" href="#Non-dimensional-SIR-D-model" title="Permalink to this headline">¶</a></h3>
<p>Set <span class="math notranslate nohighlight">\((S, I, R, D) = N \times (x, y, z, w)\)</span> and <span class="math notranslate nohighlight">\((T, \alpha, \beta, \gamma) = (\tau t, \tau^{-1} \kappa, \tau^{-1} \rho, \tau^{-1} \sigma)\)</span>.
This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x}{\mathrm{d}t}= - \rho x y  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= \rho x y - (\sigma + \kappa) y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
&amp; \frac{\mathrm{d}w}{\mathrm{d}t}= \kappa y  \\
\end{align*}</div><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIR-D
{&#39;param_dict&#39;: {&#39;kappa&#39;: 0.005, &#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Fatal&#39;: 0,
             &#39;Infected&#39;: 1000,
             &#39;Recovered&#39;: 0,
             &#39;Susceptible&#39;: 999000}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRD</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_16_0.png" src="_images/usage_theoretical_16_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="SIR-F-model">
<h2>SIR-F model<a class="headerlink" href="#SIR-F-model" title="Permalink to this headline">¶</a></h2>
<p>In the initial phase of COVID-19 outbreak, many cases were confirmed after they died. To consider this issue, “S + I <span class="math notranslate nohighlight">\(\to\)</span> Fatal + I” will be added to the model. When <span class="math notranslate nohighlight">\(\alpha_{1}=0\)</span>, SIR-F model will be the same as SIR-D model.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta I}{\longrightarrow} \mathrm{S}^\ast \overset{\alpha_1}{\longrightarrow}\ &amp; \mathrm{F}    \\
\mathrm{S}^\ast \overset{1 - \alpha_1}{\longrightarrow}\ &amp; \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}    \\
&amp; \mathrm{I} \overset{\alpha_2}{\longrightarrow} \mathrm{F}    \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible (= Population - Confirmed)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span>: Confirmed and un-categorized</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Confirmed and categorized as Infected</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Confirmed and categorized as Recovered</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{F}\)</span>: Confirmed and categorzied as Fatal</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha_1\)</span>: Direct fatality probability of <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> (non-dimensional)</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha_2\)</span>: Mortality rate of Infected cases <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span>: Effective contact rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
<div class="line-block">
<div class="line">Notes on <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> variable:</div>
<div class="line"><span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> describes the cases who are actually carriers of the disease without anyone (including themselves) knowing about it, who either die and they are confirmed positive after death, while some others are moved to infected after being confirmed.</div>
</div>
<p>In JHU-style dataset, we know the number of cases who were confirmed with COVID-19, but we do not know the number of died cases who died without COVID-19. Essentially <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> serves as an auxiliary compartment in SIR-F model to separate the two death situations and insert a probability factor of {<span class="math notranslate nohighlight">\(\alpha_1\)</span>, <span class="math notranslate nohighlight">\(1 - \alpha_1\)</span>}.</p>
<div class="line-block">
<div class="line">Notes on the difference of SIR-D and SIR-F model:</div>
<div class="line"><span class="math notranslate nohighlight">\(\alpha_1\)</span> is small at this time because performance of PCR tests was improved, but we can use SIR-F model rather than SIR-D model as an enhanced model even now becase <span class="math notranslate nohighlight">\(\alpha_1\)</span> can be 0 in the ODE model.</div>
</div>
<div class="section" id="Non-dimensional-SIR-F-model">
<h3>Non-dimensional SIR-F model<a class="headerlink" href="#Non-dimensional-SIR-F-model" title="Permalink to this headline">¶</a></h3>
<p>Set <span class="math notranslate nohighlight">\((S, I, R, F) = N \times (x, y, z, w)\)</span> and <span class="math notranslate nohighlight">\((T, \alpha_1, \alpha_2, \beta, \gamma) = (\tau t, \theta, \tau^{-1} \kappa, \tau^{-1} \rho, \tau^{-1} \sigma)\)</span>.
This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x}{\mathrm{d}t}= - \rho x y  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= \rho (1-\theta) x y - (\sigma + \kappa) y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
&amp; \frac{\mathrm{d}w}{\mathrm{d}t}= \rho \theta x y + \kappa y  \\
\end{align*}</div><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIR-F
{&#39;param_dict&#39;: {&#39;kappa&#39;: 0.005, &#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075, &#39;theta&#39;: 0.002},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Fatal&#39;: 0,
             &#39;Infected&#39;: 1000,
             &#39;Recovered&#39;: 0,
             &#39;Susceptible&#39;: 999000}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_22_0.png" src="_images/usage_theoretical_22_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="SEWIR-F-model-(SIR-F-with-exposed/waiting-cases)">
<h2>SEWIR-F model (SIR-F with exposed/waiting cases)<a class="headerlink" href="#SEWIR-F-model-(SIR-F-with-exposed/waiting-cases)" title="Permalink to this headline">¶</a></h2>
<p>The number of exposed cases in latent period (E) and wating cases for confirmation (W) are un-measurable variables, but key variables as well as S, I, R, F. If E and W are large, outbreak will occur in the near future. Let’s replace S<span class="math notranslate nohighlight">\(\overset{\beta I}{\longrightarrow}\)</span>S<span class="math notranslate nohighlight">\(^\ast\)</span> as follows because W also has infectivity.</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathrm{S} \overset{\beta_1 (W+I)}{\longrightarrow} \mathrm{E} \overset{\beta_2}{\longrightarrow} \mathrm{W} \overset{\beta_3}{\longrightarrow} \mathrm{S}^\ast \overset{\alpha_1}{\longrightarrow}\ &amp; \mathrm{F}    \\
\mathrm{S}^\ast \overset{1 - \alpha_1}{\longrightarrow}\ &amp; \mathrm{I} \overset{\gamma}{\longrightarrow} \mathrm{R}    \\
&amp; \mathrm{I} \overset{\alpha_2}{\longrightarrow} \mathrm{F}    \\
\end{align*}</div><p>Variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}\)</span>: Susceptible</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{E}\)</span>: Exposed and in latent period (without infectivity)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{W}\)</span>: Waiting for confirmaion fiagnosis (with infectivity)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span>: Confirmed and un-categorized</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{I}\)</span>: Confirmed and categorized as Infected</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{R}\)</span>: Confirmed and categorized as Recovered</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{F}\)</span>: Confirmed and categorzied as Fatal</p></li>
</ul>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha_1\)</span>: Direct fatality probability of <span class="math notranslate nohighlight">\(\mathrm{S}^\ast\)</span> (non-dimensional)</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha_2\)</span>: Mortality rate of Infected cases <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span>: Exposure rate (the nymber of encounter with the virus in a minute) <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span>: Inverse of latent period <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_3\)</span>: Inverse of waiting time for confirmation <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span>: Recovery rate <span class="math notranslate nohighlight">\(\mathrm{[1/min]}\)</span></p></li>
</ul>
</div>
<div class="section" id="Non-dimensional-SEWIR-F-model">
<h2>Non-dimensional SEWIR-F model<a class="headerlink" href="#Non-dimensional-SEWIR-F-model" title="Permalink to this headline">¶</a></h2>
<p>Set <span class="math notranslate nohighlight">\((S, E, W, I, R, F) = N \times (x_1, x_2, x_3, y, z, w)\)</span>, <span class="math notranslate nohighlight">\((T, \alpha_1) = (\tau t, \theta)\)</span> and <span class="math notranslate nohighlight">\((\alpha_2, \beta_i, \gamma) = \tau^{-1} \times (\kappa, \rho_i, \sigma)\)</span>.
This results in the ODE</p>
<div class="math notranslate nohighlight">
\begin{align*}
&amp; \frac{\mathrm{d}x_1}{\mathrm{d}t}= - \rho_1 x_1 (x_3 + y)  \\
&amp; \frac{\mathrm{d}x_2}{\mathrm{d}t}= \rho_1 x_1 (x_3 + y) - \rho_2 x_2  \\
&amp; \frac{\mathrm{d}x_3}{\mathrm{d}t}= \rho_2 x_2 - \rho_3 x_3  \\
&amp; \frac{\mathrm{d}y}{\mathrm{d}t}= (1-\theta) \rho_3 x_3 - (\sigma + \kappa) y  \\
&amp; \frac{\mathrm{d}z}{\mathrm{d}t}= \sigma y  \\
&amp; \frac{\mathrm{d}w}{\mathrm{d}t}= \theta \rho_3 x_3 + \kappa y  \\
\end{align*}</div><div class="line-block">
<div class="line">Note:</div>
<div class="line"><strong>We cannot use SEWIR-F model for parameter estimation because we do not have records of Exposed and Waiting. Please use SIR-F model with covsirphy.SIRF class.</strong></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="c1"># Example parameter values</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SEWIR-F
{&#39;param_dict&#39;: {&#39;kappa&#39;: 0.005,
                &#39;rho1&#39;: 0.2,
                &#39;rho2&#39;: 0.167,
                &#39;rho3&#39;: 0.167,
                &#39;sigma&#39;: 0.075,
                &#39;theta&#39;: 0.002},
 &#39;population&#39;: 1000000,
 &#39;step_n&#39;: 180,
 &#39;y0_dict&#39;: {&#39;Exposed&#39;: 3000,
             &#39;Fatal&#39;: 0,
             &#39;Infected&#39;: 1000,
             &#39;Recovered&#39;: 0,
             &#39;Susceptible&#39;: 994000,
             &#39;Waiting&#39;: 0.002}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SEWIRF</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;province&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="p">}</span>
<span class="c1"># Add records with SIR model</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Records with model variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">specialized</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Example data of </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">NAME</span><span class="si">}</span><span class="s2"> model&quot;</span><span class="p">,</span> <span class="n">y_integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_27_0.png" src="_images/usage_theoretical_27_0.png" />
</div>
</div>
</div>
<div class="section" id="SIR-F-model-with-vaccination">
<h2>SIR-F model with vaccination<a class="headerlink" href="#SIR-F-model-with-vaccination" title="Permalink to this headline">¶</a></h2>
<p>In the previous version, we defined SIR-FV model with <span class="math notranslate nohighlight">\(\omega\)</span> (vaccination rate) and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\mathrm{d}S}{\mathrm{d}T}= - \beta S I - \omega N  \\\end{split}\]</div>
<p>However, <strong>SIR-FV model was removed because vaccinated persons may move to the other compartments. Please use SIR-F model and adjust parameter values of SIR-F model, considering the impact of vaccinations on infectivity, effectivity and safety.</strong></p>
</div>
<div class="section" id="SIR-S-model">
<h2>SIR-S model<a class="headerlink" href="#SIR-S-model" title="Permalink to this headline">¶</a></h2>
<p>Re-infection (Recovered -&gt; Susceptble) is sometimes reported and we can consider SIR-S (SIR-FS) model. However, this is not impremented at this time because we do not have data regarding re-infection. SIR-F model could be the final model in our data-driven approach at this time.</p>
<p>Re-infection changes the parameter values of SIR-F model. There are two patterns.</p>
<ol class="arabic simple">
<li><p>If re-infected case is counted as a new confirmed case and removed from “Recovered” compartment, <span class="math notranslate nohighlight">\(\sigma\)</span> will be decreased.</p></li>
<li><p>If re-infected case is counted as a new confirmed case and NOT removed from “Recovered” compartment, <span class="math notranslate nohighlight">\(\rho\)</span> will be increased because “Susceptible” will be decreased.</p></li>
</ol>
</div>
<div class="section" id="Scenario-analysis-with-theoretical-data">
<h2>Scenario analysis with theoretical data<a class="headerlink" href="#Scenario-analysis-with-theoretical-data" title="Permalink to this headline">¶</a></h2>
<p>Because <code class="docutils literal notranslate"><span class="pre">ExampleData</span></code> class is a subclass of <code class="docutils literal notranslate"><span class="pre">JHUData</span></code>, we can perform scenario analysis with example datasets easily. Here, we will use the following scenarios. For explanation, <span class="math notranslate nohighlight">\(\tau=1440\)</span>, the start date is 01Jan2020, population is 1,000,000 and country name is “Theoretical”. <strong>Their scenarios are not based on actual data.</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 21%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>01Jan2020 - 31Jan2020</p></th>
<th class="head"><p>01Feb2020 - 31Dec2020</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Main</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F</p></td>
</tr>
<tr class="row-odd"><td><p>Lockdown</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F with 50% of <span class="math notranslate nohighlight">\(\rho\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Medicine</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F with 50% of <span class="math notranslate nohighlight">\(\kappa\)</span> and 200% of <span class="math notranslate nohighlight">\(\sigma\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Vaccine</p></td>
<td><p>SIR-F</p></td>
<td><p>SIR-F with 80% of <span class="math notranslate nohighlight">\(\rho\)</span>, 60% of <span class="math notranslate nohighlight">\(\kappa\)</span> and 120% of <span class="math notranslate nohighlight">\(\sigma\)</span></p></td>
</tr>
</tbody>
</table>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Preset of SIR-F parameters</span>
<span class="n">preset_dict</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">[</span><span class="s2">&quot;param_dict&quot;</span><span class="p">]</span>
<span class="n">preset_dict</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;theta&#39;: 0.002, &#39;kappa&#39;: 0.005, &#39;rho&#39;: 0.2, &#39;sigma&#39;: 0.075}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">area</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Theoretical&quot;</span><span class="p">}</span>
<span class="c1"># Create dataset from 01Jan2020 to 31Jan2020</span>
<span class="n">example_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="p">,</span> <span class="n">step_n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="c1"># Register population value</span>
<span class="n">population_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="p">[</span><span class="s2">&quot;population&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">population_data</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="o">**</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1000000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show records with Scenario class</span>
<span class="n">snl</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">Scenario</span><span class="p">(</span><span class="n">example_data</span><span class="p">,</span> <span class="n">population_data</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">1440</span><span class="p">,</span> <span class="o">**</span><span class="n">area</span><span class="p">)</span>
<span class="n">record_df</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">records</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">record_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">record_df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
<span class="c1"># From version 2.17.0, we will prefer to use</span>
<span class="c1"># snl = cs.Scenario(**area)</span>
<span class="c1"># snl.register(example_data, population_data)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_33_0.png" src="_images/usage_theoretical_33_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Infected</th>
      <th>Fatal</th>
      <th>Recovered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-02</td>
      <td>1127</td>
      <td>6</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-03</td>
      <td>1270</td>
      <td>12</td>
      <td>169</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-04</td>
      <td>1430</td>
      <td>19</td>
      <td>271</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-05</td>
      <td>1612</td>
      <td>28</td>
      <td>385</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-06</td>
      <td>1816</td>
      <td>37</td>
      <td>513</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Infected</th>
      <th>Fatal</th>
      <th>Recovered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>2020-01-27</td>
      <td>21210</td>
      <td>940</td>
      <td>13068</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2020-01-28</td>
      <td>23730</td>
      <td>1061</td>
      <td>14753</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2020-01-29</td>
      <td>26524</td>
      <td>1196</td>
      <td>16637</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2020-01-30</td>
      <td>29616</td>
      <td>1347</td>
      <td>18741</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2020-01-31</td>
      <td>33030</td>
      <td>1515</td>
      <td>21088</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="line-block">
<div class="line">Note:</div>
<div class="line">Record on 01Jan2020 was removed because the number of recovered cases is 0 and this sometimes causes error in estimation.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set 0th phase from 02Jan2020 to 31Jan2020 with preset parameter values</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">include_past</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Jan2020&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">SIRF</span><span class="p">,</span> <span class="o">**</span><span class="n">preset_dict</span><span class="p">)</span>
<span class="n">snl</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type</th>
      <th>Start</th>
      <th>End</th>
      <th>Population</th>
      <th>ODE</th>
      <th>Rt</th>
      <th>theta</th>
      <th>kappa</th>
      <th>rho</th>
      <th>sigma</th>
      <th>tau</th>
      <th>alpha1 [-]</th>
      <th>1/alpha2 [day]</th>
      <th>1/beta [day]</th>
      <th>1/gamma [day]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.5</td>
      <td>0.002</td>
      <td>0.005</td>
      <td>0.2</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200</td>
      <td>5</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add main scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Main&quot;</span><span class="p">)</span>
<span class="c1"># Add lockdown scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lockdown&quot;</span><span class="p">)</span>
<span class="n">rho_lock</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lockdown&quot;</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="n">rho_lock</span><span class="p">)</span>
<span class="c1"># Add medicine scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Medicine&quot;</span><span class="p">)</span>
<span class="n">kappa_med</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kappa&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="n">sigma_med</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Medicine&quot;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa_med</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_med</span><span class="p">)</span>
<span class="c1"># Add vaccine scenario</span>
<span class="n">snl</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vaccine&quot;</span><span class="p">)</span>
<span class="n">rho_vac</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span>
<span class="n">kappa_vac</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kappa&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.6</span>
<span class="n">sigma_vac</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0th&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">snl</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;31Dec2020&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vaccine&quot;</span><span class="p">,</span>  <span class="n">rho</span><span class="o">=</span><span class="n">rho_vac</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">kappa_vac</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_vac</span><span class="p">)</span>
<span class="c1"># Summarize</span>
<span class="n">snl</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Type</th>
      <th>Start</th>
      <th>End</th>
      <th>Population</th>
      <th>ODE</th>
      <th>Rt</th>
      <th>theta</th>
      <th>kappa</th>
      <th>rho</th>
      <th>sigma</th>
      <th>tau</th>
      <th>alpha1 [-]</th>
      <th>1/alpha2 [day]</th>
      <th>1/beta [day]</th>
      <th>1/gamma [day]</th>
    </tr>
    <tr>
      <th>Scenario</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Main</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200</td>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200</td>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Lockdown</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200</td>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>1.25</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.10</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200</td>
      <td>10</td>
      <td>13</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Medicine</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200</td>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>1.31</td>
      <td>0.002</td>
      <td>0.0025</td>
      <td>0.20</td>
      <td>0.150</td>
      <td>1440</td>
      <td>0.002</td>
      <td>400</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Vaccine</th>
      <th>0th</th>
      <td>Past</td>
      <td>02Jan2020</td>
      <td>31Jan2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>2.50</td>
      <td>0.002</td>
      <td>0.0050</td>
      <td>0.20</td>
      <td>0.075</td>
      <td>1440</td>
      <td>0.002</td>
      <td>200</td>
      <td>5</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1st</th>
      <td>Future</td>
      <td>01Feb2020</td>
      <td>31Dec2020</td>
      <td>1000000</td>
      <td>SIR-F</td>
      <td>1.72</td>
      <td>0.002</td>
      <td>0.0030</td>
      <td>0.16</td>
      <td>0.090</td>
      <td>1440</td>
      <td>0.002</td>
      <td>333</td>
      <td>6</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="Compare-the-scenarios">
<h3>Compare the scenarios<a class="headerlink" href="#Compare-the-scenarios" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Describe the scenarios</span>
<span class="n">snl</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>max(Infected)</th>
      <th>argmax(Infected)</th>
      <th>Confirmed on 01Jan2021</th>
      <th>Infected on 01Jan2021</th>
      <th>Fatal on 01Jan2021</th>
      <th>1st_Rt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Main</th>
      <td>232568</td>
      <td>02Mar2020</td>
      <td>891643</td>
      <td>0</td>
      <td>57398</td>
      <td>2.50</td>
    </tr>
    <tr>
      <th>Lockdown</th>
      <td>47079</td>
      <td>08Mar2020</td>
      <td>443712</td>
      <td>106</td>
      <td>28555</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>Medicine</th>
      <td>53837</td>
      <td>22Feb2020</td>
      <td>491125</td>
      <td>0</td>
      <td>10181</td>
      <td>1.31</td>
    </tr>
    <tr>
      <th>Vaccine</th>
      <td>114877</td>
      <td>09Mar2020</td>
      <td>710872</td>
      <td>0</td>
      <td>25070</td>
      <td>1.72</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;Rt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_39_0.png" src="_images/usage_theoretical_39_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;Infected&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_40_0.png" src="_images/usage_theoretical_40_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;Fatal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_41_0.png" src="_images/usage_theoretical_41_0.png" />
</div>
</div>
</div>
<div class="section" id="Simulation-of-each-scenario">
<h3>Simulation of each scenario<a class="headerlink" href="#Simulation-of-each-scenario" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Main&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_43_0.png" src="_images/usage_theoretical_43_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lockdown&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_44_0.png" src="_images/usage_theoretical_44_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Medicine&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_45_0.png" src="_images/usage_theoretical_45_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">_</span> <span class="o">=</span> <span class="n">snl</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vaccine&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/usage_theoretical_46_0.png" src="_images/usage_theoretical_46_0.png" />
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="covsirphy.html" class="btn btn-neutral float-right" title="covsirphy package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="usage_phases.html" class="btn btn-neutral float-left" title="Usage: phases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, CovsirPhy Development Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>